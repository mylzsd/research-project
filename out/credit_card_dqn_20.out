192-168-1-134:research-project Lzs$ python src/run.py -d credit_card -a dqn -n 20 -t 5000
{'dataset': 'credit_card', 'algorithm': 'dqn', 'num_clf': 20, 'num_training': 5000, 'learning_rate': 0.01, 'discount_factor': 1.0, 'epsilon': 0.1, 'random_state': 8865, 'n_estimators': 1, 'portion': 0.5}
(13500, 31)
(13500, 31)
(3000, 31)
WARNING:tensorflow:From /Users/Lzs/anaconda3/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
2019-04-18 02:46:12.853656: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
WARNING:tensorflow:From /Users/Lzs/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/losses/losses_impl.py:277: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
finished epoch 10
average policy cost: 0.304451060295105
average value loss: 0.09800000190734863
accuracy: 0.482
[[1146 1202]
 [ 352  300]]
finished epoch 20
average policy cost: 0.3044544219970703
average value loss: 0.09800000190734863
accuracy: 0.5103333333333333
[[1228 1120]
 [ 349  303]]
finished epoch 30
average policy cost: 0.30445549488067625
average value loss: 0.09800000190734863
accuracy: 0.5043333333333333
[[1175 1173]
 [ 314  338]]
finished epoch 40
average policy cost: 0.3044520378112793
average value loss: 0.09599999785423279
accuracy: 0.49933333333333335
[[1173 1175]
 [ 327  325]]
finished epoch 50
average policy cost: 0.30445539951324463
average value loss: 0.09599999785423279
accuracy: 0.492
[[1142 1206]
 [ 318  334]]
finished epoch 60
average policy cost: 0.30445873737335205
average value loss: 0.09599999785423279
accuracy: 0.49333333333333335
[[1155 1193]
 [ 327  325]]
finished epoch 70
average policy cost: 0.30438406467437745
average value loss: 0.10399999618530273
accuracy: 0.506
[[1192 1156]
 [ 326  326]]
finished epoch 80
average policy cost: 0.304447340965271
average value loss: 0.09599999785423279
accuracy: 0.5046666666666667
[[1183 1165]
 [ 321  331]]
finished epoch 90
average policy cost: 0.3044597625732422
average value loss: 0.09599999785423279
accuracy: 0.49366666666666664
[[1166 1182]
 [ 337  315]]
finished epoch 100
average policy cost: 0.3043499231338501
average value loss: 0.10199999809265137
accuracy: 0.5006666666666667
[[1179 1169]
 [ 329  323]]
finished epoch 110
average policy cost: 0.3044597148895264
average value loss: 0.09399999976158142
accuracy: 0.49133333333333334
[[1158 1190]
 [ 336  316]]
finished epoch 120
average policy cost: 0.3044563055038452
average value loss: 0.09800000190734863
accuracy: 0.49766666666666665
[[1167 1181]
 [ 326  326]]
finished epoch 130
average policy cost: 0.3043248414993286
average value loss: 0.10800000429153442
accuracy: 0.5036666666666667
[[1177 1171]
 [ 318  334]]
finished epoch 140
average policy cost: 0.30445396900177
average value loss: 0.09399999976158142
accuracy: 0.504
[[1202 1146]
 [ 342  310]]
finished epoch 150
average policy cost: 0.30445730686187744
average value loss: 0.08600000143051148
accuracy: 0.512
[[1210 1138]
 [ 326  326]]
finished epoch 160
average policy cost: 0.30445840358734133
average value loss: 0.08600000143051148
accuracy: 0.47833333333333333
[[1114 1234]
 [ 331  321]]
finished epoch 170
average policy cost: 0.3042886257171631
average value loss: 0.11399999856948853
accuracy: 0.49466666666666664
[[1164 1184]
 [ 332  320]]
finished epoch 180
average policy cost: 0.30428009033203124
average value loss: 0.11599999666213989
accuracy: 0.49866666666666665
[[1191 1157]
 [ 347  305]]
finished epoch 190
average policy cost: 0.3044640302658081
average value loss: 0.08799999952316284
accuracy: 0.48
[[1095 1253]
 [ 307  345]]
finished epoch 200
average policy cost: 0.30425071716308594
average value loss: 0.1100000023841858
accuracy: 0.5006666666666667
[[1184 1164]
 [ 334  318]]
finished epoch 210
average policy cost: 0.3042346715927124
average value loss: 0.1059999942779541
accuracy: 0.49066666666666664
[[1160 1188]
 [ 340  312]]
finished epoch 220
average policy cost: 0.3044651746749878
average value loss: 0.09599999785423279
accuracy: 0.5093333333333333
[[1211 1137]
 [ 335  317]]
finished epoch 230
average policy cost: 0.3042097806930542
average value loss: 0.10399999618530273
accuracy: 0.5213333333333333
[[1244 1104]
 [ 332  320]]
finished epoch 240
average policy cost: 0.3044697046279907
average value loss: 0.1
accuracy: 0.49633333333333335
[[1166 1182]
 [ 329  323]]
finished epoch 250
average policy cost: 0.30418212413787843
average value loss: 0.1
accuracy: 0.5046666666666667
[[1190 1158]
 [ 328  324]]
finished epoch 260
average policy cost: 0.30446300506591795
average value loss: 0.1059999942779541
accuracy: 0.49
[[1141 1207]
 [ 323  329]]
finished epoch 270
average policy cost: 0.3044618844985962
average value loss: 0.1059999942779541
accuracy: 0.498
[[1168 1180]
 [ 326  326]]
finished epoch 280
average policy cost: 0.3041400909423828
average value loss: 0.09399999976158142
accuracy: 0.511
[[1193 1155]
 [ 312  340]]
finished epoch 290
average policy cost: 0.30446419715881345
average value loss: 0.10800000429153442
accuracy: 0.515
[[1214 1134]
 [ 321  331]]
finished epoch 300
average policy cost: 0.3044675588607788
average value loss: 0.10399999618530273
accuracy: 0.49833333333333335
[[1163 1185]
 [ 320  332]]
finished epoch 310
average policy cost: 0.3041025876998901
average value loss: 0.09200000166893005
accuracy: 0.5066666666666667
[[1205 1143]
 [ 337  315]]
finished epoch 320
average policy cost: 0.3044744491577148
average value loss: 0.11200000047683716
accuracy: 0.49733333333333335
[[1168 1180]
 [ 328  324]]
finished epoch 330
average policy cost: 0.3040764331817627
average value loss: 0.09000000357627869
accuracy: 0.5043333333333333
[[1179 1169]
 [ 318  334]]
finished epoch 340
average policy cost: 0.3040645599365234
average value loss: 0.09000000357627869
accuracy: 0.5156666666666667
[[1197 1151]
 [ 302  350]]
finished epoch 350
average policy cost: 0.30405263900756835
average value loss: 0.09000000357627869
accuracy: 0.5003333333333333
[[1164 1184]
 [ 315  337]]
finished epoch 360
average policy cost: 0.3044745445251465
average value loss: 0.1100000023841858
accuracy: 0.49866666666666665
[[1176 1172]
 [ 332  320]]
finished epoch 370
average policy cost: 0.3044846296310425
average value loss: 0.1059999942779541
accuracy: 0.52
[[1211 1137]
 [ 303  349]]
finished epoch 380
average policy cost: 0.3044790983200073
average value loss: 0.1059999942779541
accuracy: 0.49366666666666664
[[1157 1191]
 [ 328  324]]
finished epoch 390
average policy cost: 0.3044757604598999
average value loss: 0.10399999618530273
accuracy: 0.501
[[1204 1144]
 [ 353  299]]
finished epoch 400
average policy cost: 0.30448360443115235
average value loss: 0.1
accuracy: 0.5043333333333333
[[1191 1157]
 [ 330  322]]
finished epoch 410
average policy cost: 0.3044667959213257
average value loss: 0.09800000190734863
accuracy: 0.491
[[1145 1203]
 [ 324  328]]
finished epoch 420
average policy cost: 0.30398406982421877
average value loss: 0.10199999809265137
accuracy: 0.5063333333333333
[[1185 1163]
 [ 318  334]]
finished epoch 430
average policy cost: 0.30397179126739504
average value loss: 0.10199999809265137
accuracy: 0.5053333333333333
[[1195 1153]
 [ 331  321]]
finished epoch 440
average policy cost: 0.3044658899307251
average value loss: 0.10199999809265137
accuracy: 0.505
[[1185 1163]
 [ 322  330]]
finished epoch 450
average policy cost: 0.3039470911026001
average value loss: 0.10199999809265137
accuracy: 0.5006666666666667
[[1178 1170]
 [ 328  324]]
finished epoch 460
average policy cost: 0.30446820259094237
average value loss: 0.09800000190734863
accuracy: 0.514
[[1199 1149]
 [ 309  343]]
finished epoch 470
average policy cost: 0.3044738292694092
average value loss: 0.09200000166893005
accuracy: 0.4866666666666667
[[1152 1196]
 [ 344  308]]
finished epoch 480
average policy cost: 0.3039179563522339
average value loss: 0.10800000429153442
accuracy: 0.5026666666666667
[[1187 1161]
 [ 331  321]]
finished epoch 490
average policy cost: 0.30389702320098877
average value loss: 0.10199999809265137
accuracy: 0.515
[[1223 1125]
 [ 330  322]]
finished epoch 500
average policy cost: 0.3038843870162964
average value loss: 0.10199999809265137
accuracy: 0.502
[[1188 1160]
 [ 334  318]]
finished epoch 510
average policy cost: 0.3044921636581421
average value loss: 0.10199999809265137
accuracy: 0.5033333333333333
[[1196 1152]
 [ 338  314]]
finished epoch 520
average policy cost: 0.3038503885269165
average value loss: 0.09599999785423279
accuracy: 0.48633333333333334
[[1141 1207]
 [ 334  318]]
finished epoch 530
average policy cost: 0.30446321964263917
average value loss: 0.10399999618530273
accuracy: 0.5076666666666667
[[1180 1168]
 [ 309  343]]
finished epoch 540
average policy cost: 0.30382747650146485
average value loss: 0.09800000190734863
accuracy: 0.48933333333333334
[[1176 1172]
 [ 360  292]]
finished epoch 550
average policy cost: 0.30446338653564453
average value loss: 0.10399999618530273
accuracy: 0.5063333333333333
[[1197 1151]
 [ 330  322]]
finished epoch 560
average policy cost: 0.30449368953704836
average value loss: 0.09800000190734863
accuracy: 0.503
[[1167 1181]
 [ 310  342]]
finished epoch 570
average policy cost: 0.3037970781326294
average value loss: 0.10399999618530273
accuracy: 0.5093333333333333
[[1202 1146]
 [ 326  326]]
finished epoch 580
average policy cost: 0.3037781476974487
average value loss: 0.1
accuracy: 0.5003333333333333
[[1167 1181]
 [ 318  334]]
finished epoch 590
average policy cost: 0.3045017957687378
average value loss: 0.1
accuracy: 0.503
[[1189 1159]
 [ 332  320]]
finished epoch 600
average policy cost: 0.3044828653335571
average value loss: 0.09399999976158142
accuracy: 0.5033333333333333
[[1175 1173]
 [ 317  335]]
finished epoch 610
average policy cost: 0.30375018119812014
average value loss: 0.10800000429153442
accuracy: 0.49666666666666665
[[1159 1189]
 [ 321  331]]
finished epoch 620
average policy cost: 0.3045053482055664
average value loss: 0.09399999976158142
accuracy: 0.49733333333333335
[[1174 1174]
 [ 334  318]]
finished epoch 630
average policy cost: 0.304468560218811
average value loss: 0.09200000166893005
accuracy: 0.501
[[1187 1161]
 [ 336  316]]
finished epoch 640
average policy cost: 0.3045011043548584
average value loss: 0.09200000166893005
accuracy: 0.5163333333333333
[[1206 1142]
 [ 309  343]]
finished epoch 650
average policy cost: 0.30448663234710693
average value loss: 0.08600000143051148
accuracy: 0.51
[[1191 1157]
 [ 313  339]]
finished epoch 660
average policy cost: 0.3036859750747681
average value loss: 0.1100000023841858
accuracy: 0.5076666666666667
[[1172 1176]
 [ 301  351]]
finished epoch 670
average policy cost: 0.3045003652572632
average value loss: 0.09200000166893005
accuracy: 0.5066666666666667
[[1181 1167]
 [ 313  339]]
finished epoch 680
average policy cost: 0.30450384616851806
average value loss: 0.09200000166893005
accuracy: 0.505
[[1201 1147]
 [ 338  314]]
finished epoch 690
average policy cost: 0.30364189147949217
average value loss: 0.10800000429153442
accuracy: 0.4866666666666667
[[1135 1213]
 [ 327  325]]
finished epoch 700
average policy cost: 0.30448641777038576
average value loss: 0.09800000190734863
accuracy: 0.503
[[1192 1156]
 [ 335  317]]
finished epoch 710
average policy cost: 0.3045054912567139
average value loss: 0.09800000190734863
accuracy: 0.5056666666666667
[[1186 1162]
 [ 321  331]]
finished epoch 720
average policy cost: 0.3035909414291382
average value loss: 0.10199999809265137
accuracy: 0.474
[[1106 1242]
 [ 336  316]]
finished epoch 730
average policy cost: 0.3044901371002197
average value loss: 0.09399999976158142
accuracy: 0.49966666666666665
[[1199 1149]
 [ 352  300]]
finished epoch 740
average policy cost: 0.30449576377868653
average value loss: 0.09000000357627869
accuracy: 0.507
[[1199 1149]
 [ 330  322]]
finished epoch 750
average policy cost: 0.30356426239013673
average value loss: 0.11200000047683716
accuracy: 0.5026666666666667
[[1177 1171]
 [ 321  331]]
finished epoch 760
average policy cost: 0.304504919052124
average value loss: 0.08799999952316284
accuracy: 0.48233333333333334
[[1127 1221]
 [ 332  320]]
finished epoch 770
average policy cost: 0.30450398921966554
average value loss: 0.08799999952316284
accuracy: 0.4876666666666667
[[1171 1177]
 [ 360  292]]
finished epoch 780
average policy cost: 0.3035151481628418
average value loss: 0.10800000429153442
accuracy: 0.49
[[1151 1197]
 [ 333  319]]
finished epoch 790
average policy cost: 0.3044888496398926
average value loss: 0.09200000166893005
accuracy: 0.503
[[1190 1158]
 [ 333  319]]
finished epoch 800
average policy cost: 0.30348303318023684
average value loss: 0.1059999942779541
accuracy: 0.51
[[1194 1154]
 [ 316  336]]
finished epoch 810
average policy cost: 0.30346524715423584
average value loss: 0.10399999618530273
accuracy: 0.48033333333333333
[[1146 1202]
 [ 357  295]]
finished epoch 820
average policy cost: 0.3034440755844116
average value loss: 0.1
accuracy: 0.508
[[1214 1134]
 [ 342  310]]
finished epoch 830
average policy cost: 0.30450973510742185
average value loss: 0.09800000190734863
accuracy: 0.512
[[1202 1146]
 [ 318  334]]
finished epoch 840
average policy cost: 0.3044933319091797
average value loss: 0.1
accuracy: 0.5223333333333333
[[1230 1118]
 [ 315  337]]
finished epoch 850
average policy cost: 0.3034095048904419
average value loss: 0.1059999942779541
accuracy: 0.5016666666666667
[[1166 1182]
 [ 313  339]]
finished epoch 860
average policy cost: 0.30339457988739016
average value loss: 0.1059999942779541
accuracy: 0.5033333333333333
[[1150 1198]
 [ 292  360]]
finished epoch 870
average policy cost: 0.30338292121887206
average value loss: 0.10800000429153442
accuracy: 0.5003333333333333
[[1194 1154]
 [ 345  307]]
finished epoch 880
average policy cost: 0.303361177444458
average value loss: 0.10399999618530273
accuracy: 0.514
[[1194 1154]
 [ 304  348]]
finished epoch 890
average policy cost: 0.3044729232788086
average value loss: 0.09399999976158142
accuracy: 0.499
[[1162 1186]
 [ 317  335]]
finished epoch 900
average policy cost: 0.30333082675933837
average value loss: 0.10399999618530273
accuracy: 0.5146666666666667
[[1213 1135]
 [ 321  331]]
finished epoch 910
average policy cost: 0.30450685024261476
average value loss: 0.09399999976158142
accuracy: 0.5033333333333333
[[1197 1151]
 [ 339  313]]
finished epoch 920
average policy cost: 0.30449025630950927
average value loss: 0.09000000357627869
accuracy: 0.5076666666666667
[[1200 1148]
 [ 329  323]]
finished epoch 930
average policy cost: 0.30451388359069825
average value loss: 0.09200000166893005
accuracy: 0.49
[[1152 1196]
 [ 334  318]]
finished epoch 940
average policy cost: 0.3032760381698608
average value loss: 0.10800000429153442
accuracy: 0.5013333333333333
[[1167 1181]
 [ 315  337]]
finished epoch 950
average policy cost: 0.3045278310775757
average value loss: 0.1
accuracy: 0.5026666666666667
[[1193 1155]
 [ 337  315]]
finished epoch 960
average policy cost: 0.3045093059539795
average value loss: 0.1
accuracy: 0.48733333333333334
[[1145 1203]
 [ 335  317]]
finished epoch 970
average policy cost: 0.3045130014419556
average value loss: 0.10399999618530273
accuracy: 0.498
[[1162 1186]
 [ 320  332]]
finished epoch 980
average policy cost: 0.3045098066329956
average value loss: 0.1
accuracy: 0.5013333333333333
[[1195 1153]
 [ 343  309]]
finished epoch 990
average policy cost: 0.3031833410263062
average value loss: 0.1
accuracy: 0.48933333333333334
[[1161 1187]
 [ 345  307]]
finished epoch 1000
average policy cost: 0.3031530618667603
average value loss: 0.09200000166893005
accuracy: 0.506
[[1184 1164]
 [ 318  334]]
finished epoch 1010
average policy cost: 0.30448074340820314
average value loss: 0.1059999942779541
accuracy: 0.5143333333333333
[[1189 1159]
 [ 298  354]]
finished epoch 1020
average policy cost: 0.304524302482605
average value loss: 0.1059999942779541
accuracy: 0.496
[[1159 1189]
 [ 323  329]]
finished epoch 1030
average policy cost: 0.3045234203338623
average value loss: 0.10399999618530273
accuracy: 0.49666666666666665
[[1166 1182]
 [ 328  324]]
finished epoch 1040
average policy cost: 0.30452699661254884
average value loss: 0.10399999618530273
accuracy: 0.49066666666666664
[[1167 1181]
 [ 347  305]]
finished epoch 1050
average policy cost: 0.30451934337615966
average value loss: 0.09800000190734863
accuracy: 0.5026666666666667
[[1201 1147]
 [ 345  307]]
finished epoch 1060
average policy cost: 0.3030840873718262
average value loss: 0.10800000429153442
accuracy: 0.5076666666666667
[[1196 1152]
 [ 325  327]]
finished epoch 1070
average policy cost: 0.30306756496429443
average value loss: 0.10800000429153442
accuracy: 0.5036666666666667
[[1181 1167]
 [ 322  330]]
finished epoch 1080
average policy cost: 0.303054666519165
average value loss: 0.1100000023841858
accuracy: 0.5
[[1194 1154]
 [ 346  306]]
finished epoch 1090
average policy cost: 0.3045268297195435
average value loss: 0.09000000357627869
accuracy: 0.5023333333333333
[[1189 1159]
 [ 334  318]]
finished epoch 1100
average policy cost: 0.3030249834060669
average value loss: 0.11200000047683716
accuracy: 0.5143333333333333
[[1210 1138]
 [ 319  333]]
finished epoch 1110
average policy cost: 0.30450527667999266
average value loss: 0.08799999952316284
accuracy: 0.5113333333333333
[[1212 1136]
 [ 330  322]]


